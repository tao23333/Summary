# 前言

> 设计模式定义：每一个模式描述了一个在我们周围不断重复发生的问题以及该问题的解决方案的核心。这样，你就能一次又一次地使用该方案而不必做重复劳动。

>  设计模式主要解决变化中的复用性问题
>
>  - 设计模式目标：应对变化，提高复用
>
>  - 设计模式要点：寻找变化点，思考是否违背了设计原则，(若违背)然后在变化点处应用设计模式；
>
>    设计模式的应用不宜先入为主，一上来就是用设计模式是对设计模式最大的误用。没有一步到位的设计模式。敏捷开发倡导的==“Refactoring to Patterns”==（重构到模式）是目前普遍公认的最好地应用设计模式的方法
>
>    - 重构关键技法：
>      - 静态 -> 动态
>      - 早绑定 -> 晚绑定
>      - 继承 -> 组合
>      - 编译时依赖 -> 运行时依赖
>      - 紧耦合 -> 松耦合
>    
>  - 设计模式中的“复用”：是指在二进制层面的复用，即将源代码编译，测试，部署之后不对其源代码更改导致二次编译，直接用之前部署好的二进制代码。
>
>    - 源代码片段的多次使用属于复制级别，不是复用
>    
>  - 设计模式的依赖关系，不特殊说明都是指编译时依赖
>
>    - A依赖B，则A在编译时，B必须存在A才可以编译通过
>
>  

补：准确的继承关系

- 准确的继承关系应该是类属关系，而非父子关系
  - 比如，动物继承自生物，人类又继承自动物；汽车继承自交通工具....

---

# 面向对象设计原则

> 一些原则是相辅相成的，它们是从不同角度看待同一个问题；往往违背了其中一个原则，同时也违背了其他的某几个原则

## 依赖倒置（DIP）[贯穿所有设计模式]

- 高层模块（稳定）不应该依赖于低层模块（变化），二者都应该依赖于抽象（稳定）
  - 高层模块依赖于低层模块：MainForm 依赖于 Line、Rectangle
  - 二者依赖于抽象：MainForm只依赖于Shape（Line和Rectangle的抽象父类），Line，Rectangle只依赖于Shape
- 抽象（稳定）不应该依赖于实现细节（变化），实现细节应该依赖于抽象（稳定）
  - 如果Shape中有引用了其子类Line，这就是抽象依赖了实现细节



## 开放封闭（OCP）

- 类模块应该是可扩展的，但是不可修改
  - 如果需要增加画Circle的功能，只需在外部新建一个Circle类文件等，而不需要在MainForm源码上直接进行修改；对源码直接修改意味着对该MainForm类文件重新编译，重新测试，重新部署



## 单一职责（SRP）

- 一个类应该仅有一个引起它变化的原因（变化意味着责任）
  - 如果一个类有几十种成员函数，一般是不正常的。每个成员函数意味着它的一种责任，每中责任将类向不同的方向拉扯，最终导致问题的出现



## Liskov替换原则（LSP）

- 子类必须能够替换它们的基类（IS-A）
  - 所有需要父类的地方，子类对象都可以传过去



## 接口隔离原则（ISP）

- 不应该强迫客户程序依赖它们不用的方法（接口应该小而完备）
  - 每个类只暴露（public）外界要使用的接口，如果某个接口只是本类使用，则应该私有（private）



## 优先对象组合，而非类继承

- 类继承在某种程度上破坏了封装性（父类给子类暴露的东西过多），子类父类耦合度高；而对象组合（A类中放入B类的指针或者对象）只要求被组合的对象具有良好定义的接口，耦合度低



## 封装变化点

- 使用封装来创建对象间的分界层，让设计者可以在分界层的一侧进行修改而不会对另一侧产生不良影响，从而实现层次间的松耦合



## 针对接口编程，而不是针对实现编程

- 不将变量类型（业务变量）声明为某个特定的具体类，而是声明为某个接口（抽象类）
- 客户程序无需获知对象的具体类型，只需知道对象所具有的接口



# 23中设计模式的分类

## 组件协作

- Template Method
- Strategy
- Observer / Event



## 单一职责

- Decorator
- Bridge



## 对象创建

- Factory Method
- Abstract Factory
- Prototype
- Builder



## 对象性能

- Singleton
- Flyweight



## 接口隔离

- Facade
- Proxy
- Mediator
- Adapter



## 状态变化

- Memento
- State



## 数据结构

- Composite
- Iterator
- Chain of  Responsibility



## 行为变化

- Command
- Visitor



## 领域问题

- Interpreter



































































































